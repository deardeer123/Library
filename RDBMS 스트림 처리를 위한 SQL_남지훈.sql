
-- 1 
CREATE TABLE MY_MEMBER(
	MEMBER_NUM INT PRIMARY KEY AUTO_INCREMENT
	, MEMBER_ID VARCHAR(20) NOT NULL
	, MEMBER_PW VARCHAR(20) NOT NULL
	, MEMBER_NAME VARCHAR(10) NOT NULL
	, MEMBER_AGE INT NOT NULL
	, MEMBER_EMAIL VARCHAR(50)
);

-- 2
INSERT INTO MY_MEMBER(
	MEMBER_NUM
	, MEMBER_ID
	, MEMBER_PW
	, MEMBER_NAME
	, MEMBER_AGE 
)VALUES(
	1
	,'JAVA'
	,'1234'
	,'HONG'
	,20
);

DELETE FROM my_member
WHERE MEMBER_NUM = 1;

-- 3

UPDATE my_member
SET MEMBER_NAME = '김자바',
	MEMBER_ID = 'KIMJAVA'
WHERE MEMBER_NUM = 1;

SELECT * FROM my_member;

-- 4 
SELECT 
	EMPNO
	,ENAME
	,SAL
	,COMM
FROM emp
WHERE (SAL >= 500 AND SAL <= 3000)
AND COMM IS NOT NULL;

SELECT * FROM emp;
-- 5
SELECT 
	EMPNO
	,ENAME
	,HIREDATE
FROM emp
WHERE ENAME LIKE '%기'OR ENAME LIKE '%김%'
ORDER BY EMPNO DESC;

-- 6

SELECT
	EMPNO
	,ENAME
	,DEPTNO
	,CASE
		WHEN DEPTNO = 10 THEN '인사부' 
		WHEN DEPTNO = 20 THEN '영업부' 
		WHEN DEPTNO = 30 THEN '개발부'
		ELSE '생산부'
	END AS '부서'
FROM emp ;

-- 7
SELECT
	EMPNO
	,ENAME
	,HIREDATE
	,IFNULL(COMM , 0) AS COMM
FROM emp
WHERE DATE_FORMAT(HIREDATE, '%m') = 01
ORDER BY HIREDATE ASC;

-- 8
SELECT
	JOB
	,SUM(SAL)
	,AVG(SAL)
	,AVG(COMM)
FROM emp
GROUP BY JOB
ORDER BY SUM(SAL) DESC;

-- 9
SELECT
	EMPNO
	,ENAME
	,HIREDATE
	,SAL
	,DEPTNO
	,(SELECT DNAME FROM dept WHERE DNAME = '인사부')
FROM emp
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = '인사부');

SELECT * FROM dept;

-- 10
SELECT 
	EMPNO
	,ENAME
	,HIREDATE
	,SAL
	,E.DEPTNO
	,DNAME
FROM emp AS E
INNER JOIN dept AS D
ON E.DEPTNO = D.DEPTNO
WHERE DNAME != '인사부'
ORDER BY EMPNO DESC, ENAME ASC;

