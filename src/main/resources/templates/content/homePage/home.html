<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{fragment/homePage/homePage_layout}">

<th:block layout:fragment="content_css">
    <!-- html ÌååÏùºÏù¥ Ïó¥Î¶¥Îïå Í∞ôÏù¥ Ïã§ÌñâÎêòÎäî css -->
    <!-- <link rel="stylesheet" href="/"> -->
</th:block>

<th:block layout:fragment="contentFragment">
    <style>
        /* calendar.html */
        .cursor-td {
            cursor: pointer;
        }

        .fc-col-header-cell-cushion,
        .fc-daygrid-day-number {
            text-decoration: none;
        }

        .fc .fc-toolbar.fc-header-toolbar {
            text-decoration: underline;
            color: white;
            background-color: #8BC3A9;
            padding-top: 0.3em;
            padding-bottom: 0.2em;
            padding-left: 1em;
            margin-bottom: auto;
        }

        .fc-dayGridMonth-view {
            border: 1px solid #8BC3A9;

        }

        .fc-scrollgrid-sync-inner>.fc-col-header-cell-cushion,
        .fc-day-mon .fc-daygrid-day-number,
        .fc-day-tue .fc-daygrid-day-number,
        .fc-day-wed .fc-daygrid-day-number,
        .fc-day-thu .fc-daygrid-day-number,
        .fc-day-fri .fc-daygrid-day-number {
            color: black;
        }

        .fc-day-sun .fc-col-header-cell-cushion,
        .fc-day-sun a {
            color: red;
        }

        .fc-day-sat .fc-col-header-cell-cushion,
        .fc-day-sat a {
            color: blue;
        }
    </style>
    <!-- html ÏΩîÎìú ÏûëÏÑ± -->
    <div class="row">
        <div class="col">
            <div class="row">
                <div class="col text-white bg-opacity-25" style="position: relative;">
                    <img src="/upload/159159.gif" style="width: 100%; height: 200px;">
                    <!-- Ï±ÖÍ≤ÄÏÉâÍ∏∞Îä• -->
                    <!-- <div class="row mt-4 mb-5 ms-3" style="height: 12vh;">
                        <div class="col"> -->
                    <div class="row "
                        style="margin-top: 4vh; position: absolute; top: 20%; left: 10%; z-index: 1; width: 70%;">
                        <div class="col-3"></div>
                        <div class="col-2">
                            <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ -->
                            <select class="form-select" aria-label="Default select example" name="searchType"
                                id="search-type" style="height: 5vh;">
                                <option value="BOOK_TITLE" th:selected="${bookSearchVO.searchType == 'BOOK_TITLE' }">Ï±ÖÏù¥Î¶Ñ
                                </option>
                                <option value="BOOK_WRITER" th:selected="${bookSearchVO.searchType == 'BOOK_WRITER'}">Ï†ÄÏûê
                                </option>
                                <option value="BOOK_PUB" th:selected="${bookSearchVO.searchType == 'BOOK_PUB'}">
                                    Ï∂úÌåêÏÇ¨
                                </option>
                            </select>
                        </div>
                        <div class="col-4">
                            <!-- Í≤ÄÏÉâ -->
                            <input type="text" class="form-control" name="searchValue" id="search-value"
                                style="height: 5vh;" th:value="${bookSearchVO.searchValue}">
                        </div>
                        <div class="col-1">
                            <!-- Í≤ÄÏÉâ Î≤ÑÌäº -->
                            <input type="submit" class="btn text-white" value="Í≤ÄÏÉâ"
                                style="background-color: #4F9D79; height: 5vh;">
                        </div>

                        <!-- <div class="col-4"
                                    style="font-family: YEONGJUSeonbiTTF; font-size: 1.5em; font-weight: 300;">
                                    <div>Ï±Ö ÏùΩÎäî ÎãπÏã†ÏùÑ ÏúÑÌïú Í∑∏Î¶∞ ÎèÑÏÑúÍ¥Äüìñ</div>
                                </div> -->
                    </div>
                    <!-- </div>
                    </div> -->
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-6">
                    <!-- Í≥µÏßÄÏÇ¨Ìï≠ -->
                    <div class="row mt-4">
                        <div class="col bg-success text-white bg-opacity-50">
                            <div class="fs-3 p-1" style=" text-decoration : underline;">Í≥µÏßÄÏÇ¨Ìï≠</div>
                        </div>
                    </div>
                    <div class="row ">
                        <div class="col bg-success bg-opacity-50">
                            <table class="table ">
                                <colgroup>
                                    <col width="30%">
                                    <col width="*">
                                </colgroup>
                                <tbody class="">
                                    <th:block th:each="e:${noticeList}">
                                        <tr>
                                            <td>[[${e.boardDate}]]</td>
                                            <td class="cursor-td" th:onclick="goNotice([[${e.boardNum}]])">
                                                [[${e.boardTitle}]]</td>
                                        </tr>
                                    </th:block>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ÌñâÏÇ¨Ï†ïÎ≥¥ -->
                    <div class="row mt-4">
                        <div class="col ">
                            <div class="row">
                                <div class="col bg-success text-white bg-opacity-50">
                                    <div class="fs-3 p-1" style=" text-decoration : underline;">ÌñâÏÇ¨Ï†ïÎ≥¥</div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col bg-success text-white bg-opacity-50">
                                    <table class="table">
                                        <colgroup>
                                            <col width="30%">
                                            <col width="*">
                                        </colgroup>
                                        <tbody>
                                            <th:block th:each="event : ${eventList}">
                                                <tr>
                                                    <td>[[${event.boardDate}]]</td>
                                                    <td class="cursor-td" th:onclick="goEvent([[${event.boardNum}]])">
                                                        [[${event.boardTitle}]]</td>
                                                </tr>
                                            </th:block>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-6">

                    <!-- Îã¨Î†• -->
                    <div class="row">
                        <div class="col-1"></div>
                        <div class="col">
                            <div id='calendar' style="width: 100%; font-size: 0.8em;"></div>
                        </div>
                    </div>
                </div>



            </div>

            <div class="row">
                <div class="col-6">
                    <!-- Ï±Ö Ï∂îÏ≤ú, ÏÉàÎ°ú Îì§Ïñ¥Ïò® Ï±Ö,  -->
                    <div class="row mt-2 mb-2" id="book-list-tag">

                        <input type="hidden" name="type" th:value="${type}">
                        <div class="col d-grid">
                            <!-- #5F9EA0 -->
                            <button class="btn text-white" style="background-color: #4F9D79;"
                                onclick="findBookList('recommend')">Ï∂îÏ≤úÎèÑÏÑú</button>
                        </div>
                        <div class="col d-grid">
                            <button class="btn text-white" style="background-color: #4F9D79;"
                                onclick="findBookList('new')">ÏÉàÎ°úÎì§Ïñ¥Ïò® Ï±Ö</button>
                        </div>
                        <div class="col d-grid">
                            <button class="btn text-white" style="background-color: #4F9D79;"
                                onclick="findBookList('many')">ÎåÄÏ∂úÏù¥
                                ÎßéÏùÄ Ï±Ö</button>
                        </div>

                    </div>

                    <div class="row mt-1 bg-success-subtle" id="bookList-type-div">
                        <div class="text-center mb-1" style="font-size: 2em; font-weight: bold; ">
                            <span class="bg-success-subtle bg-opacity-75" style="display: inline-block; width: 10vw;">
                                [[${type}]]
                            </span>
                        </div>
                        <th:block th:each="e:${bookList}">
                            <div class="col-4 text-center">
                                <div class="row">
                                    <div class="col">
                                        <img th:src="@{/upload/} + ${e.bookInfoAttachedFileName}" width="60%"
                                            style="height: 20vh;">
                                    </div>
                                </div>
                                <div class="row ">
                                    <div class="col">
                                        [[${e.bookTitle}]]
                                    </div>
                                </div>
                            </div>
                        </th:block>
                    </div>
                </div>
                <div class="col-6">
                    <!-- ÌñâÏÇ¨ -->
                    <div class="row mt-1 mb-2">
                        <div class="col-1"></div>
                        <div class="col">
                            <div class="fs-3 text-white"
                                style="background-color: #8BC3A9; text-decoration : underline;"><span
                                    class="ms-2">ÌñâÏÇ¨Ï†ïÎ≥¥</span></div>
                            <div class="">
                                <div id="carouselExampleIndicators" class="carousel slide">
                                    <div class="carousel-indicators">
                                        <button type="button" data-bs-target="#carouselExampleIndicators"
                                            data-bs-slide-to="0" class="active" aria-current="true"
                                            aria-label="Slide 1"></button>
                                        <button type="button" data-bs-target="#carouselExampleIndicators"
                                            data-bs-slide-to="1" aria-label="Slide 2"></button>
                                        <button type="button" data-bs-target="#carouselExampleIndicators"
                                            data-bs-slide-to="2" aria-label="Slide 3"></button>
                                    </div>
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <img src="/upload/f4d4330e-9b95-44fa-8243-db2a0141de89.jpg"
                                                style="height: 60vh;" width="100%" alt="...">
                                        </div>
                                        <div class="carousel-item">
                                            <img src="/upload/3a5b56c7-9516-4584-8292-ba1957b6e315.jpg"
                                                style="height: 60vh;" width="100%" alt="...">
                                        </div>
                                        <div class="carousel-item">
                                            <img src="/upload/f4d4330e-9b95-44fa-8243-db2a0141de89.jpg"
                                                style="height: 60vh;" width="100%" alt="...">
                                        </div>
                                    </div>
                                    <button class="carousel-control-prev" type="button"
                                        data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button"
                                        data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Next</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- ÏòÅÌôîÏÉÅÏòÅ -->

        </div>
    </div>
    <!-- Ïù¥Í±∞ Îã¨Î†• Î∂àÎü¨Ïò§Îäî Ïä§ÌÅ¨Î¶ΩÌä∏ Ï£ºÏÜå ÏûÖÎãàÎã§ Îã¨Î†• ÌëúÏãúÌïòÍ≥† Ïã∂ÏúºÎ©¥ Íº≠ ÎÑ£ÏúºÏÑ∏Ïöî -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
    <script>
        //Îã¨Î†• ÏùΩÏñ¥Ïò§Í∏∞
        calendarData();

        function goNotice(boardNum) {
            location.href = `/goNotice?boardNum=${boardNum}`
        }

        function goEvent(boardNum) {
            location.href = `/goDetailParticipation?boardNum=${boardNum}`
        }

        function findBookList(type) {

            let bookListTypeDiv = document.querySelector("#bookList-type-div");
            bookListTypeDiv.innerHTML = ''


            // ------------------- Ï≤´Î≤àÏß∏ Î∞©Ïãù ---------------//
            // Îã¨Î†• Ï†ïÎ≥¥ Î∂àÎü¨Ïò§Îäî Ïª®Ìä∏Î°§Îü¨ Ï£ºÏÜåÎäî ÏïÑÎûòÏóê ÏûàÏà®
            fetch('/homeBookList', { //ÏöîÏ≤≠Í≤ΩÎ°ú
                method: 'POST',
                cache: 'no-cache',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
                },
                //Ïª®Ìä∏Î°§Îü¨Î°ú Ï†ÑÎã¨Ìï† Îç∞Ïù¥ÌÑ∞
                body: new URLSearchParams({
                    // Îç∞Ïù¥ÌÑ∞Î™Ö : Îç∞Ïù¥ÌÑ∞Í∞í
                    type: type
                })
            })
                .then((response) => {
                    if (!response.ok) {
                        alert('fetch error!\nÏª®Ìä∏Î°§Îü¨Î°ú ÌÜµÏã†Ï§ëÏóê Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                        return;
                    }

                    //return response.text(); //Ïª®Ìä∏Î°§Îü¨ÏóêÏÑú returnÌïòÎäî Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÍ±∞ÎÇò int, String Ïùº Îïå ÏÇ¨Ïö©
                    return response.json(); //ÎÇòÎ®∏ÏßÄ Í≤ΩÏö∞Ïóê ÏÇ¨Ïö©
                })
                //fetch ÌÜµÏã† ÌõÑ Ïã§Ìñâ ÏòÅÏó≠
                .then((data) => {//data -> controllerÏóêÏÑú Î¶¨ÌÑ¥ÎêòÎäî Îç∞Ïù¥ÌÑ∞!
                    console.log(data)

                    let korType = ''
                  
                    


                    let str = ``;
                    str += `
                        <div class="text-center mb-1" style="font-size: 2em; font-weight: bold; ">
                                <span class="bg-success-subtle bg-opacity-75" style="display: inline-block; width: 10vw;">
                                    ${data.type}
                                </span>
                        </div>
                    `
                    data.bookList.forEach((e, idx) => {
                        str += `
                        <div class="col-4 text-center">
                            <div class="row">
                                <div class="col">
                                    <img src="/upload/${e.bookInfoAttachedFileName}" width="60%"
                                        style="height: 20vh;">
                                </div>
                            </div>
                            <div class="row ">
                                <div class="col">
                                    ${e.bookTitle}
                                </div>
                            </div>
                        </div>
                        `
                    });
                    bookListTypeDiv.insertAdjacentHTML('afterbegin', str);
                })
                //fetch ÌÜµÏã† Ïã§Ìå® Ïãú Ïã§Ìñâ ÏòÅÏó≠
                .catch(err => {
                    alert('fetch error!\nthen Íµ¨Î¨∏ÏóêÏÑú Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\nÏΩòÏÜîÏ∞ΩÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî!');
                    console.log(err);
                });
        }

        function calendarData() {
            // ------------------- Ï≤´Î≤àÏß∏ Î∞©Ïãù ---------------//
            //Îã¨Î†• Ï†ïÎ≥¥ Î∂àÎü¨Ïò§Îäî Ïª®Ìä∏Î°§Îü¨ Ï£ºÏÜåÎäî ÏïÑÎûòÏóê ÏûàÏà®
            fetch('/calendarData2Fetch', { //ÏöîÏ≤≠Í≤ΩÎ°ú
                method: 'POST',
                cache: 'no-cache',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
                },
                //Ïª®Ìä∏Î°§Îü¨Î°ú Ï†ÑÎã¨Ìï† Îç∞Ïù¥ÌÑ∞
                body: new URLSearchParams({
                    // Îç∞Ïù¥ÌÑ∞Î™Ö : Îç∞Ïù¥ÌÑ∞Í∞í
                })
            })
                .then((response) => {
                    if (!response.ok) {
                        alert('fetch error!\nÏª®Ìä∏Î°§Îü¨Î°ú ÌÜµÏã†Ï§ëÏóê Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                        return;
                    }

                    //return response.text(); //Ïª®Ìä∏Î°§Îü¨ÏóêÏÑú returnÌïòÎäî Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÍ±∞ÎÇò int, String Ïùº Îïå ÏÇ¨Ïö©
                    return response.json(); //ÎÇòÎ®∏ÏßÄ Í≤ΩÏö∞Ïóê ÏÇ¨Ïö©
                })
                //fetch ÌÜµÏã† ÌõÑ Ïã§Ìñâ ÏòÅÏó≠
                .then((data) => {//data -> controllerÏóêÏÑú Î¶¨ÌÑ¥ÎêòÎäî Îç∞Ïù¥ÌÑ∞!
                    let eventList = []
                    eventList = data
                    console.log(eventList)


                    var calendarEl = document.getElementById('calendar');
                    var calendar = new FullCalendar.Calendar(calendarEl, {
                        //ÎÜíÏù¥ Ï°∞Ï†à
                        height: 420,
                        // Ïª®ÌÖêÏ∏† ÎÜíÏù¥ Ï°∞Ï†à
                        contentHeight: 375,

                        //ÏãúÍ∞ÑÌëúÏãú Ï†úÍ±∞ÌïòÍ∏∞
                        displayEventTime: false,
                        expandRows: true,

                        //ÎπÑÏú® Ï°∞Ï†à
                        //aspectRatio: 1.8,

                        themeSystem: 'bootstrap5',
                        //Ìó§Îçî
                        headerToolbar: {
                            start: 'title',
                            center: '',
                            end: ''
                        },


                        initialView: 'dayGridMonth',
                        locale: 'ko',
                        //Ïù¥Î≤§Ìä∏
                        events: eventList

                    });
                    calendar.render();



                })
                //fetch ÌÜµÏã† Ïã§Ìå® Ïãú Ïã§Ìñâ ÏòÅÏó≠
                .catch(err => {
                    alert('fetch error!\nthen Íµ¨Î¨∏ÏóêÏÑú Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\nÏΩòÏÜîÏ∞ΩÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî!');
                    console.log(err);
                });

        }
    </script>

</th:block>

<th:block layout:fragment="content_js">
    <!-- html ÌååÏùºÏù¥ Ïó¥Î¶¥Îïå Í∞ôÏù¥ Ïã§ÌñâÎêòÎäî js -->
    <!-- <script src="/"></script> -->
</th:block>

</html>