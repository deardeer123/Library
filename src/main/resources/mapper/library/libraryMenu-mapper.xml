<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 해당 파일에 모든 쿼리문을 작성 -->
<mapper namespace="libraryMenuMapper">
<!--    헤더 메뉴-->
    <resultMap id="headerMenu" type="com.green.Library.library.libraryMenu.vo.LibraryHeaderMenuVO">
        <id column="MENU_NUM" property="menuNum" />
        <result column="MENU_NAME" property="menuName" />
        <result column="MENU_PAGE" property="menuPage" />
        <result column="MENU_INDEX" property="menuIndex" />
        <result column="MENU_TYPE" property="menuType" />
        <collection property="LibrarySideMenuVOList" resultMap="libraryMenuMapper.sideMenu" />
    </resultMap>
<!--사이드 메뉴-->
    <resultMap id="sideMenu" type="com.green.Library.library.libraryMenu.vo.LibrarySideMenuVO">
        <id column="SIDE_MENU_NUM" property="sideMenuNum" />
        <result column="SIDE_MENU_NAME" property="sideMenuName" />
        <result column="SIDE_MENU_PAGE" property="sideMenuPage" />
        <result column="SIDE_MENU_INDEX" property="sideMenuIndex" />
        <result column="MENU_NUM" property="menuNum" />
    </resultMap>

<!--헤더 메뉴 및 사이드 메뉴 불러오기-->
    <select id="selectLibraryMenuList" resultMap="headerMenu">
        SELECT
        header_menu.MENU_NUM ,
        MENU_NAME ,
        MENU_INDEX ,
        MENU_TYPE,
        SIDE_MENU_NAME ,
        SIDE_MENU_PAGE ,
        SIDE_MENU_INDEX ,
        SIDE_MENU.SIDE_MENU_NUM
        FROM
        header_menu INNER JOIN side_menu
        ON header_menu.MENU_NUM = side_menu.MENU_NUM
        WHERE header_menu.MENU_TYPE = 'library'
    </select>

    <!--헤더 메뉴 및 사이드 메뉴 불러오기-->
    <select id="selectLibraryMenuList2" resultMap="headerMenu">
        SELECT
        header_menu.MENU_NUM ,
        MENU_NAME ,
        MENU_INDEX ,
        MENU_TYPE,
        SIDE_MENU_NAME ,
        SIDE_MENU_PAGE ,
        SIDE_MENU_INDEX ,
        SIDE_MENU.SIDE_MENU_NUM
        FROM
        header_menu INNER JOIN side_menu
        ON header_menu.MENU_NUM = side_menu.MENU_NUM
        WHERE header_menu.MENU_TYPE = #{menuType}
    </select>


    <!--    페이지의 이름으로 부터 header_menu의 인덱스 번호와 side_menu의 인덱스 번호 구하기-->
    <select id="selectIndexNum" resultType="map">
        SELECT
        side_menu.SIDE_MENU_INDEX ,
        header_menu.MENU_INDEX ,
        side_menu.SIDE_MENU_NUM
        FROM
        side_menu INNER JOIN header_menu
        ON side_menu.MENU_NUM = header_menu.MENU_NUM
        WHERE side_menu.side_menu_page = #{page}
    </select>


</mapper>































