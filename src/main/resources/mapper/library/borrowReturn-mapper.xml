<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 해당 파일에 모든 쿼리문을 작성 -->
<mapper namespace="borrowReturnMapper">

<resultMap id="bookBorrow" type="com.green.Library.library.borrowReturn.vo.BookBorrowVO">
    <id          column="BR_CODE"         property="brCode"/>
    <result      column="BR_DATE"         property="brDate"/>
    <result      column="BOOK_CNT"        property="bookCnt"/>
    <result      column="RETURN_YN"       property="returnYN"/>
    <result      column="RETURN_DATE"     property="returnDate"/>
    <result      column="USER_CODE"       property="userCode"/>
    <result      column="BOOK_CODE"       property="bookCode"/>
    <association property="libraryMember" resultMap="libraryMemberMapper.libAdmMember"/>
</resultMap>

    <!-- 이용자의 대출 정보 조회-->
    <select id="borrowInfo" resultMap="bookBorrow">
        SELECT USER.USER_CODE
            , USER_NAME
            , USER_TEL
            , BR_CODE
            , BR_DATE
            , BOOK_CNT
            , RETURN_YN
            , RETURN_DATE
            , BB.BOOK_CODE
            , BOOK_TITLE
        FROM BOOK_BORROW AS BB
        INNER JOIN USERS AS USER
        ON USER.USER_CODE = BB.USER_CODE
        INNER JOIN BOOK_INFO AS BI
        ON BB.BOOK_CODE = BI.BOOK_CODE
        INNER JOIN book AS B
        ON B.BOOK_CODE = BB.BOOK_CODE
        WHERE BB.USER_CODE = #{userCode}
        ORDER BY BR_DATE DESC
    </select>



</mapper>































